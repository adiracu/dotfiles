#!/bin/bash

# If there is an Internet connection, it will proceed and run the
#   install_all.sh scripts found inside the detected labels folders


function e_header()   { echo -e "\n\033[1m$@\033[0m"; }
function e_success()  { echo -e " \033[1;32m✔\033[0m  $@"; }
function e_error()    { echo -e " \033[1;31m✖\033[0m  $@"; }
function e_arrow()    { echo -e " \033[1;33m➜\033[0m  $@"; }

# CHECK INTERNET CONNECTION FIRST

# Try to ping 1 packet,
# Timeout 1 second
if ! ping -W 1 -c 1 www.google.com; then
	if ! ping -W 1 -c1 www.yahoo.com; then
		e_error "There is no internet connection (Or both Google and Yahoo are down). Abandoning installation of packages."
		exit 1
	fi
fi

for label in `cat ~/.dotfiles/conf/labels_detected` ; do

	if test -d "${label}"; then

		pushd "${label}" &>/dev/null

			if test -f "install_all"; then
				/bin/bash install_all
	 		fi

   	popd &>/dev/null

	fi

done

